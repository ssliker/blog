# Redis-string存储结构功能特征

## 1.string存储结构的特征：

​	1.string类型的数据结构指redis中key-value中的value存储的是 ***数值*** 和 ***字符串***，并且所存储的字符串内容是二进制安全的；

​	2.key在redis中必须唯一，不能重复，否则将会覆盖掉旧的同名数据，所存储的内容则可以任意；key的值本身是二进制安全的，可以将任何字符序列作为key;

​	3.在Redis中，管理字符串类型的数据模型类似于下方图示：

​			<img src="%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-03-23%20%E4%B8%8B%E5%8D%888.52.48.png" style="zoom:50%;" />

## 2.string存储结构的操作：

> **1.新增类指令**

------

**指令：**SET

**语法：**`SET key value [ex 秒] [px 毫秒] [nx/xx]`

**功能：**向redis中添加一个key-value，并且支持给key设置过期时间和新增条件；如果该key不存在，则新增一个；如果该key已经存在则使用新值覆盖掉旧值，并重置过期时间；

**参数：**key：存储内容的名称，即键名；

​		   value：要存储的内容，可以是数值或者字符串；

​			ex 秒：支持以秒为单位设置该key的过期时间；

​			px毫秒：支持以毫秒为单位设置该key的过期时间，ex和px只能使用一个；

​			nx：nx表示当key不存在时才允许设置该key，如果存在则直接返回不做任何处理；

​			ex：ex表示当key存在时才允许覆盖key的旧值，如果key不存在则直接返回不做任何处理；

**使用说明：**

​	1.该操作是一个原子操作；

**使用场景：**

​	1.缓存；

​	2.分布式锁；

------

**指令：**SETEX

**语法：**`SETEX key seconds value`

**功能：**向redis中添加一个key-value，并且支持给key设置过期时间；如果该key不存在，则新增一个；如果该key已经存在则使用新值覆盖掉旧值，并重置过期时间；类似于`SET key value ex 秒`

**参数：**key：存储内容的名称，即键名；

​			seconds：过期时间，以秒为单位；

​		   value：要存储的内容，可以是数值或者字符串；

**使用说明：**

​	1.redis官方声明，由于SET指令增强之后，已经完全可以替代SETEX，因此在往后的版本中并不推荐使用SETEX，甚至会废弃该指令；

------

**指令：**PSETEX

**语法：**`PSETEX key milliseconds value `

**功能：**向redis中添加一个key-value，并且支持给key设置过期时间；如果该key不存在，则新增一个；如果该key已经存在则使用新值覆盖掉旧值，并重置过期时间；类似于`SET key value px 秒`

**参数：**key：存储内容的名称，即键名；

​			milliseconds：过期时间，以秒为单位；

​		    value：要存储的内容，可以是数值或者字符串；

**使用说明：**

​	1.redis官方声明，由于SET指令增强之后，已经完全可以替代PSETEX，因此在往后的版本中并不推荐使用PSETEX，甚至会废弃该指令；

------

**指令：**SETNX

**语法：**SETNX key value

**功能：**向redis中添加一个key-value，如果该key不存在，则新增一个；如果该key已经存在则不做任何处理；

**参数：**key：存储内容的名称，即键名；

​		   value：要存储的内容，可以是数值或者字符串；

**使用说明：**

​	1.redis官方声明，由于SET指令增强之后，已经完全可以替代SETNX，因此在往后的版本中并不推荐使用SETNX，甚至会废弃该指令；

**使用场景：**

​	1.缓存

​	2.分布式锁，使用SETNX实现分布式锁时过期时间可以通过将键值设置为未来到期时间戳实现；

------

**指令：**MSET

**语法：**MSET key1 value1 key2 value2 key3 value3... 

**功能：**批量向redis中添加键值对；

**参数：**key：存储内容的名称，即键名；

​		   value：要存储的内容，可以是数值或者字符串；

------

> 删除类指令

------

**指令：**DEL

**语法：**DEL key1 key2 key3...

**功能：**从redis中删除一个key，返回删除成功的个数，如果key不存在，则返回0；

**参数：**key：待删除的键名；

------

> 获取类指令

------

**指令：**GET

**语法：**GET key1

**功能：**从redis中获取并返回一个key的值；

**参数：**key：待获取的键名

------

**指令：**MGET

**语法：**MGET key1 key2 key3...

**功能：**从redis中批量获取并返回key的值；

**参数：**key：待获取的键名

------

> 其他操作

------

**指令：**INCRBY

**语法：**INCRBY key increment

**功能：**如果key存在，将key的值加上增量increment；如果key不存在，则创建一个key并将其值设置为increment；

**参数：**key：待操作的键名

​			increment：增量

**使用说明：**

​		1.执行这个操作的时候，key对应存储的字符串被解析为10进制的**64位有符号整型数据**，如果所存储的字符不能转换为一个整数，将会返回一个错误；

​		2.该操作是一个原子操作；

**使用场景：**

​		1.分值增减，计数器等

------

**指令：**DECRBY

**语法：**DECRBY key increment

**功能：**如果key存在，将key的值减去增量increment；如果key不存在，则创建一个key并将其值设置为0-increment；

**参数：**key：待操作的键名

​			increment：增量

**使用说明：**

​		1.执行这个操作的时候，key对应存储的字符串被解析为10进制的**64位有符号整型数据**，如果所存储的字符不能转换为一个整数，将会返回一个错误；

​		2.该操作是一个原子操作；

**使用场景：**

​		1.分值增减，计数器等

------

**指令：**INCR

**语法：**INCR key

**功能：**如果key存在，将key的值加上1；如果key不存在，则创建一个key并将其值设置为0，然后加1；

**参数：**key：待操作的键名

**使用说明：**

​		1.执行这个操作的时候，key对应存储的字符串被解析为10进制的**64位有符号整型数据**，如果所存储的字符不能转换为一个整数，将会返回一个错误；

​		2.该操作是一个原子操作；

**使用场景：**

​		1.作为计数器：该指令的功能就是累计加1操作，适合计数，并且该操作是原子操作，不会出现多线程安全问题，所以是一个非常适合的计数器；			

​		2.作为限速器：该指令和EXPIRE指令搭配即可实现指定时间内的的访问频率，但是多条命令执行不是原子操作，如果对限速要求很精确的情况下需要使用事务来保证两条指令的原子性；

------

**指令：**DECR

**语法：**DECR key

**功能：**如果key存在，将key的值减去增量1；如果key不存在，则创建一个key并将其值设置为0，然后减1；

**参数：**key：待操作的键名

**使用说明：**

​		1.执行这个操作的时候，key对应存储的字符串被解析为10进制的**64位有符号整型数据**，如果所存储的字符不能转换为一个整数，将会返回一个错误；

​		2.该操作是一个原子操作；

------

**指令：**APPEND

**语法：**APPEND key value

**功能：**如果key存在，在key的值末尾追加字符串value；如果key不存在，则创建一个key并将其值设置为value;

**参数：**key：待操作的键名

​			value：增量

------

**指令：**SETRANGE

**语法：**SETRANGE key start value

**功能：**将key的值从start索引位置之后的字符全部由value覆盖，如果key存在，则执行上述流程，如果key不存在则创建一个key并将其值设置为value；

**参数：**key：待操作的键名

​			start：键值的索引位置

​			value：新覆盖的值

**使用说明：**该操作赶回设置之后的字符串长度；

------

**指令：**GETRANGE

**语法：**GETRANGE key start end

**功能：**获取key对应的值在start和end索引位置之间的字符序列；

**参数：**key：待操作的键名

​			start：键值的索引位置

​			end：终止索引

------

**指令：**STRLEN

**语法：**STRLEN key

**功能：**获取key对应值的长度；

**参数：**key：待操作的键名


